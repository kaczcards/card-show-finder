{"version":3,"names":["useState","useEffect","Alert","supabase","useAuth","handleSupabaseError","cov_2le0mjav29","s","useShowDetail","showId","onShare","onOpenMap","_authContext$authStat","f","_ref","_ref2","_slicedToArray","show","setShow","_ref3","_ref4","loading","setLoading","_ref5","_ref6","error","setError","_ref7","_ref8","isFavorite","setIsFavorite","_ref9","_ref0","isClaimingShow","setIsClaimingShow","_ref1","_ref10","isShowClaimed","setIsShowClaimed","_ref11","_ref12","participatingDealers","setParticipatingDealers","_ref13","_ref14","loadingDealers","setLoadingDealers","authContext","user","b","authState","_ref15","_ref16","isShowOrganizer","setIsShowOrganizer","_ref17","_ref18","isCurrentUserOrganizer","setIsCurrentUserOrganizer","userRole","role","hasOrganizerRole","fetchShowDetails","fetchParticipatingDealers","checkIfFavorite","_ref19","_asyncToGenerator","_ref20","from","select","eq","single","showData","data","showError","Error","organizerProfile","organizer_id","_ref21","profileData","profileError","combinedData","Object","assign","profiles","id","claimed_by","console","apply","arguments","_ref22","_ref23","participants","participantsError","length","participantUserIds","_toConsumableArray","Set","map","p","userid","_ref24","in","or","dealerProfiles","profilesError","dealers","profile","_ref25","_ref26","_ref27","name","first_name","last_name","trim","substring","profileImageUrl","profile_image_url","toUpperCase","accountType","account_type","_ref28","_session$user","_ref29","auth","getSession","session","_ref30","toggleFavorite","_ref31","_ref32","sessionError","alert","userId","_ref33","delete","_ref34","insert","user_id","show_id","appError","shareShow","_ref35","openMapLocation","address","location","handleClaimShow"],"sources":["useShowDetail.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { Alert } from 'react-native';\nimport { supabase } from '../../../supabase';\nimport { useAuth } from '../../../contexts/AuthContext';\nimport { handleSupabaseError } from '../../../services/errorService';\n\n// Define types for better type safety\ntype UserRole = 'SHOW_ORGANIZER' | 'MVP_DEALER' | 'DEALER' | 'USER';\n\ninterface Dealer {\n  id: string;\n  name: string;\n  profileImageUrl?: string;\n  role: UserRole;\n  accountType?: string;\n}\n\ninterface ShowDetails {\n  id: string;\n  title: string;\n  description?: string;\n  location?: string;\n  address?: string;\n  start_date?: string;\n  end_date?: string;\n  start_time?: string;\n  end_time?: string;\n  entry_fee?: number | string;\n  organizer_id?: string;\n  claimed_by?: string;\n  profiles?: {\n    id?: string;\n    first_name?: string;\n    last_name?: string;\n    profile_image_url?: string;\n    username?: string;\n    full_name?: string;\n    avatar_url?: string;\n  };\n  [key: string]: any; // For additional properties\n}\n\ninterface UseShowDetailResult {\n  show: ShowDetails | null;\n  loading: boolean;\n  error: string | null;\n  isFavorite: boolean;\n  isShowOrganizer: boolean;\n  isCurrentUserOrganizer: boolean;\n  isClaimingShow: boolean;\n  participatingDealers: Dealer[];\n  loadingDealers: boolean;\n  fetchShowDetails: () => Promise<void>;\n  toggleFavorite: () => Promise<void>;\n  shareShow: () => Promise<void>;\n  openMapLocation: () => void;\n  handleClaimShow: () => void;\n}\n\n/**\n * Custom hook to handle show detail data fetching and state management\n * @param showId The ID of the show to fetch\n * @param onShare Function to handle sharing the show\n * @param onOpenMap Function to handle opening the map\n */\nexport const useShowDetail = (\n  showId: string,\n  onShare: (show: ShowDetails) => Promise<void>,\n  onOpenMap: (address: string) => void\n): UseShowDetailResult => {\n  const [show, setShow] = useState<ShowDetails | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFavorite, setIsFavorite] = useState(false);\n  const [isClaimingShow, setIsClaimingShow] = useState(false);\n  const [isShowClaimed, setIsShowClaimed] = useState(false);\n  const [participatingDealers, setParticipatingDealers] = useState<Dealer[]>([]);\n  const [loadingDealers, setLoadingDealers] = useState(false);\n  \n  // Auth context for current user\n  const authContext = useAuth();\n  const user = authContext.authState?.user || null;\n  \n  // Derived state\n  const [isShowOrganizer, setIsShowOrganizer] = useState(false);\n  const [isCurrentUserOrganizer, setIsCurrentUserOrganizer] = useState(false);\n\n  // Check if user is a show organizer\n  useEffect(() => {\n    if (user) {\n      const userRole = user.role as UserRole;\n      const hasOrganizerRole = userRole === 'SHOW_ORGANIZER';\n      setIsShowOrganizer(hasOrganizerRole);\n    } else {\n      setIsShowOrganizer(false);\n    }\n  }, [user]);\n\n  // Fetch show details and dealers when showId changes\n  useEffect(() => {\n    fetchShowDetails();\n    fetchParticipatingDealers();\n    checkIfFavorite();\n  }, [showId]);\n\n  /**\n   * Fetch show details from the database\n   */\n  const fetchShowDetails = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      /* ------------------------------------------------------------------\n       * Step 1: Fetch the show row on its own (no joins)\n       * ------------------------------------------------------------------ */\n      const {\n        data: showData,\n        error: showError,\n      } = await supabase.from('shows').select('*').eq('id', showId).single();\n\n      if (showError) throw showError;\n      if (!showData) throw new Error('Show not found');\n\n      /* ------------------------------------------------------------------\n       * Step 2: If the show has an organiser, fetch their profile\n       * ------------------------------------------------------------------ */\n      let organizerProfile: any = null;\n      if (showData.organizer_id) {\n        const {\n          data: profileData,\n          error: profileError,\n        } = await supabase\n          .from('profiles')\n          .select(\n            'id, first_name, last_name, profile_image_url, username, full_name, avatar_url'\n          )\n          .eq('id', showData.organizer_id)\n          .single();\n\n        if (!profileError && profileData) {\n          organizerProfile = profileData;\n        }\n      }\n\n      /* ------------------------------------------------------------------\n       * Step 3: Combine the data and update component state\n       * ------------------------------------------------------------------ */\n      const combinedData = {\n        ...showData,\n        profiles: organizerProfile,\n      };\n\n      setShow(combinedData);\n      setIsCurrentUserOrganizer(user?.id === showData.organizer_id);\n      setIsShowClaimed(!!showData.claimed_by);\n    } catch (error) {\n      console.error('Error fetching show details:', error);\n      setError('Failed to load show details');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /**\n   * Fetch participating dealers for the show\n   */\n  const fetchParticipatingDealers = async () => {\n    setLoadingDealers(true);\n    try {\n      const { data: participants, error: participantsError } = await supabase\n        .from('show_participants')\n        .select('userid')\n        .eq('showid', showId);\n\n      if (participantsError) throw participantsError;\n      if (!participants || participants.length === 0) {\n        setParticipatingDealers([]);\n        return;\n      }\n\n      const participantUserIds = [...new Set(participants.map((p) => p.userid))];\n      const { data: dealerProfiles, error: profilesError } = await supabase\n        .from('profiles')\n        .select('id, first_name, last_name, profile_image_url, role, account_type')\n        .in('id', participantUserIds)\n        // Roles are stored lowercase in DB, so query accordingly\n        .or('role.eq.mvp_dealer,role.eq.dealer');\n\n      if (profilesError) throw profilesError;\n\n      const dealers = (dealerProfiles || []).map((profile) => ({\n        id: profile.id,\n        name: `${profile.first_name ?? ''} ${profile.last_name ?? ''}`.trim() || profile.id.substring(0, 8),\n        profileImageUrl: profile.profile_image_url,\n        // Normalise role to uppercase so downstream comparisons\n        // (`dealer.role === 'MVP_DEALER'`, etc.) work reliably.\n        role: ((profile.role ?? '') as string).toUpperCase() as UserRole,\n        accountType: profile.account_type,\n      }));\n      setParticipatingDealers(dealers);\n    } catch (error) {\n      console.error('Error in fetchParticipatingDealers:', error);\n      // Don't set error state here to avoid disrupting the main UI if dealers can't load\n    } finally {\n      setLoadingDealers(false);\n    }\n  };\n\n  /**\n   * Check if the current show is marked as a favorite by the user\n   */\n  const checkIfFavorite = async () => {\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session?.user?.id) {\n        setIsFavorite(false);\n        return;\n      }\n      const { data, error } = await supabase\n        .from('user_favorite_shows')\n        .select()\n        .eq('user_id', session.user.id)\n        .eq('show_id', showId)\n        .single();\n      setIsFavorite(!error && !!data);\n    } catch (error) {\n      console.error('Error checking favorite status:', error);\n    }\n  };\n\n  /**\n   * Toggle the favorite status of the show\n   */\n  const toggleFavorite = async () => {\n    try {\n      const { data: { session }, error: sessionError } = await supabase.auth.getSession();\n      if (sessionError || !session?.user) {\n        Alert.alert('Sign In Required', 'Please sign in to save favorites');\n        return;\n      }\n      const userId = session.user.id;\n\n      if (isFavorite) {\n        const { error } = await supabase\n          .from('user_favorite_shows')\n          .delete()\n          .eq('user_id', userId)\n          .eq('show_id', showId);\n        if (error) throw error;\n        setIsFavorite(false);\n      } else {\n        const { error } = await supabase\n          .from('user_favorite_shows')\n          .insert([{ user_id: userId, show_id: showId }]);\n        if (error) throw error;\n        setIsFavorite(true);\n      }\n    } catch (error) {\n      const appError = handleSupabaseError(error);\n      console.error('🚨 UNEXPECTED ERROR in toggleFavorite:', appError);\n      Alert.alert('Error', 'An unexpected error occurred while updating favorites.');\n    }\n  };\n\n  /**\n   * Share the show details\n   */\n  const shareShow = async () => {\n    if (!show) return;\n    try {\n      await onShare(show);\n    } catch (error) {\n      console.error('Error sharing:', error);\n    }\n  };\n\n  /**\n   * Open the show location in a map app\n   */\n  const openMapLocation = () => {\n    if (!show) return;\n    const address = show.address || show.location || '';\n    onOpenMap(address);\n  };\n\n  /**\n   * Handle claiming a show (placeholder)\n   */\n  const handleClaimShow = () => {\n    Alert.alert(\"Claim Show\", \"This feature is coming soon!\");\n  };\n\n  return {\n    show,\n    loading,\n    error,\n    isFavorite,\n    isShowOrganizer,\n    isCurrentUserOrganizer,\n    isClaimingShow,\n    participatingDealers,\n    loadingDealers,\n    fetchShowDetails,\n    toggleFavorite,\n    shareShow,\n    openMapLocation,\n    handleClaimShow\n  };\n};\n\nexport default useShowDetail;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,QAA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","ignoreList":[]}