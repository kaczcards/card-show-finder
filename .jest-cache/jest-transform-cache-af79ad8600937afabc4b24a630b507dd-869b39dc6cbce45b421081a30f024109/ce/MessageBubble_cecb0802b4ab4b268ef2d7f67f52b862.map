{"version":3,"names":["React","View","Text","StyleSheet","jsx","_jsx","jsxs","_jsxs","cov_1z3ao8yfht","s","MessageBubble","_ref","message","isCurrentUser","_ref$showTimestamp","showTimestamp","b","_ref$isOptimistic","isOptimistic","f","formatTime","dateString","date","Date","now","toDateString","toLocaleTimeString","hour","minute","yesterday","setDate","getDate","toLocaleDateString","month","day","isRead","read_by_user_ids","some","id","sender_id","getAccessibilityLabel","sender","time","created_at","status","message_text","style","styles","messageRow","sentMessageRow","receivedMessageRow","children","messageBubble","sentBubble","receivedBubble","optimisticBubble","accessible","accessibilityRole","accessibilityLabel","accessibilityHint","undefined","messageText","sentMessageText","receivedMessageText","messageStatusContainer","messageTime","sentMessageTime","receivedMessageTime","readStatus","sendingStatus","create","flexDirection","marginBottom","justifyContent","maxWidth","padding","borderRadius","backgroundColor","borderBottomRightRadius","borderBottomLeftRadius","borderWidth","borderColor","opacity","fontSize","color","alignItems","marginRight","fontWeight","fontStyle"],"sources":["MessageBubble.tsx"],"sourcesContent":["import React from 'react';\nimport { View, Text, StyleSheet } from 'react-native';\nimport { Message } from '../../../services/messagingService';\n\ninterface MessageBubbleProps {\n  message: Message;\n  isCurrentUser: boolean;\n  showTimestamp?: boolean;\n  isOptimistic?: boolean;\n}\n\nconst MessageBubble: React.FC<MessageBubbleProps> = ({\n  message,\n  isCurrentUser,\n  showTimestamp = true,\n  isOptimistic = false\n}) => {\n  // Format date helper function\n  const formatTime = (dateString?: string): string => {\n    if (!dateString) return '';\n    \n    const date = new Date(dateString);\n    const now = new Date();\n    \n    // If it's today, show the time\n    if (date.toDateString() === now.toDateString()) {\n      return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    }\n    \n    // If it's yesterday, show \"Yesterday\"\n    const yesterday = new Date(now);\n    yesterday.setDate(yesterday.getDate() - 1);\n    if (date.toDateString() === yesterday.toDateString()) {\n      return 'Yesterday ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    }\n    \n    // Otherwise, show the date and time\n    return date.toLocaleDateString([], { \n      month: 'short', \n      day: 'numeric' \n    }) + ' ' + date.toLocaleTimeString([], { \n      hour: '2-digit', \n      minute: '2-digit' \n    });\n  };\n\n  // Check if message has been read by someone else\n  const isRead = message.read_by_user_ids && message.read_by_user_ids.some(\n    id => id !== message.sender_id\n  );\n\n  // Create accessibility label for the message\n  const getAccessibilityLabel = () => {\n    const sender = isCurrentUser ? 'You' : 'Other user';\n    const time = formatTime(message.created_at);\n    const status = isOptimistic \n      ? 'Sending...' \n      : (isCurrentUser && isRead ? 'Read' : '');\n    \n    return `${sender}: ${message.message_text}. Sent ${time}. ${status}`;\n  };\n\n  return (\n    <View style={[\n      styles.messageRow,\n      isCurrentUser ? styles.sentMessageRow : styles.receivedMessageRow\n    ]}>\n      <View \n        style={[\n          styles.messageBubble,\n          isCurrentUser ? styles.sentBubble : styles.receivedBubble,\n          isOptimistic && styles.optimisticBubble\n        ]}\n        accessible={true}\n        accessibilityRole=\"text\"\n        accessibilityLabel={getAccessibilityLabel()}\n        accessibilityHint={isOptimistic ? \"This message is still being sent\" : undefined}\n      >\n        <Text style={[\n          styles.messageText,\n          isCurrentUser ? styles.sentMessageText : styles.receivedMessageText\n        ]}>\n          {message.message_text}\n        </Text>\n        \n        {showTimestamp && (\n          <View style={styles.messageStatusContainer}>\n            <Text \n              style={[\n                styles.messageTime,\n                isCurrentUser ? styles.sentMessageTime : styles.receivedMessageTime\n              ]}\n              accessibilityLabel={`Sent ${formatTime(message.created_at)}`}\n            >\n              {formatTime(message.created_at)}\n            </Text>\n            \n            {isCurrentUser && isRead && (\n              <Text \n                style={[styles.readStatus, styles.sentMessageTime]}\n                accessibilityLabel=\"Message has been read\"\n              >\n                • Read\n              </Text>\n            )}\n            \n            {isOptimistic && (\n              <Text \n                style={[styles.sendingStatus, styles.sentMessageTime]}\n                accessibilityLabel=\"Message is sending\"\n              >\n                • Sending...\n              </Text>\n            )}\n          </View>\n        )}\n      </View>\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  messageRow: {\n    flexDirection: 'row',\n    marginBottom: 8,\n  },\n  sentMessageRow: {\n    justifyContent: 'flex-end',\n  },\n  receivedMessageRow: {\n    justifyContent: 'flex-start',\n  },\n  messageBubble: {\n    maxWidth: '80%',\n    padding: 12,\n    borderRadius: 16,\n  },\n  sentBubble: {\n    backgroundColor: '#FF6A00',\n    borderBottomRightRadius: 4,\n  },\n  receivedBubble: {\n    backgroundColor: '#FFFFFF',\n    borderBottomLeftRadius: 4,\n    borderWidth: 1,\n    borderColor: '#E1E1E1',\n  },\n  optimisticBubble: {\n    opacity: 0.7,\n  },\n  messageText: {\n    fontSize: 16,\n    marginBottom: 4,\n  },\n  sentMessageText: {\n    color: '#FFFFFF',\n  },\n  receivedMessageText: {\n    color: '#000000',\n  },\n  messageStatusContainer: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'flex-end',\n  },\n  messageTime: {\n    fontSize: 11,\n    marginRight: 4,\n  },\n  readStatus: {\n    fontSize: 11,\n    fontWeight: '500',\n  },\n  sendingStatus: {\n    fontSize: 11,\n    fontStyle: 'italic',\n  },\n  sentMessageTime: {\n    color: 'rgba(255, 255, 255, 0.8)',\n  },\n  receivedMessageTime: {\n    color: '#777',\n  },\n});\n\nexport default MessageBubble;\n"],"mappings":"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","ignoreList":[]}