{"version":3,"names":["sanitizeCoordinates","coordinates","cov_1zdl274oa","f","s","b","console","warn","_ref","latitude","longitude","isNaN","Math","abs","originalLat","originalLong","_sanitizeCoordinates","calculateDistance","lat1","lon1","lat2","lon2","R","dLat","PI","dLon","a","sin","cos","c","atan2","sqrt"],"sources":["coordinateUtils.ts"],"sourcesContent":["/**\n * Utility functions for working with geographic coordinates\n */\nimport { Coordinates } from '../types';\n\n/**\n * Sanitizes coordinates to ensure they are valid\n * \n * This function:\n * 1. Verifies both latitude and longitude are numbers\n * 2. Detects and swaps swapped coordinates (a common error)\n * 3. Ensures latitude is between -90 and 90\n * 4. Ensures longitude is between -180 and 180\n * \n * @param coordinates The coordinates to sanitize\n * @returns Sanitized coordinates or null if invalid\n */\nexport const sanitizeCoordinates = (coordinates?: Coordinates | null): Coordinates | null => {\n  // If no coordinates provided, return null\n  if (!coordinates) {\n    console.warn('No coordinates provided to sanitize');\n    return null;\n  }\n\n  const { latitude, longitude } = coordinates;\n\n  // Verify both values are numbers\n  if (\n    typeof latitude !== 'number' ||\n    typeof longitude !== 'number' ||\n    isNaN(latitude) ||\n    isNaN(longitude)\n  ) {\n    console.warn('Invalid coordinates: latitude or longitude is not a number', { latitude, longitude });\n    return null;\n  }\n\n  // Check for swapped coordinates\n  // This is often the case when lat > 90 or long > 180\n  if (Math.abs(latitude) > 90 && Math.abs(longitude) <= 90) {\n    console.warn('Coordinates appear to be swapped - fixing automatically', { \n      originalLat: latitude, \n      originalLong: longitude \n    });\n    \n    // Swap them and proceed with the rest of the validation\n    return sanitizeCoordinates({\n      latitude: longitude,\n      longitude: latitude\n    });\n  }\n\n  // Validate latitude range (-90 to 90)\n  if (latitude < -90 || latitude > 90) {\n    console.warn('Invalid latitude value outside -90 to 90 range:', latitude);\n    return null;\n  }\n\n  // Validate longitude range (-180 to 180)\n  if (longitude < -180 || longitude > 180) {\n    console.warn('Invalid longitude value outside -180 to 180 range:', longitude);\n    return null;\n  }\n\n  // Return the valid coordinates\n  return { latitude, longitude };\n};\n\n/**\n * Calculates the distance between two points using the Haversine formula\n * @param lat1 Latitude of point 1\n * @param lon1 Longitude of point 1\n * @param lat2 Latitude of point 2\n * @param lon2 Longitude of point 2\n * @returns Distance in miles\n */\nexport const calculateDistance = (\n  lat1: number, \n  lon1: number, \n  lat2: number, \n  lon2: number\n): number => {\n  // Radius of the earth in miles\n  const R = 3958.8;\n  \n  const dLat = (lat2 - lat1) * Math.PI / 180;\n  const dLon = (lon2 - lon1) * Math.PI / 180;\n  \n  const a = \n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * \n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  \n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  return R * c;\n};\n"],"mappings":"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","ignoreList":[]}