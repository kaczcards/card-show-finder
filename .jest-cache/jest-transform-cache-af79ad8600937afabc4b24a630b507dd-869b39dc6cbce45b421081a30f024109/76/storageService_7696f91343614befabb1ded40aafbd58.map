{"version":3,"names":["supabase","StorageService","_classCallCheck","signedUrlCache","cov_q7bw4twtn","s","Map","defaultBucket","defaultExpiresIn","cacheBufferTime","_createClass","key","value","_getSignedUrl","_asyncToGenerator","path","options","arguments","length","undefined","b","f","cacheKey","getCacheKey","cachedUrl","getCachedUrl","data","error","expiresIn","transform","width","height","quality","_ref","storage","from","createSignedUrl","download","signedUrl","Error","cacheSignedUrl","console","String","getSignedUrl","_x","apply","_uploadImage","userId","file","fileName","contentType","finalFileName","Date","now","filePath","fileData","startsWith","base64Data","split","base64ToUint8Array","Blob","_ref2","upload","upsert","uploadImage","_x2","_x3","_x4","_x5","_getImage","getImage","_x6","_getUserImage","getUserImage","_x7","_x8","_deleteImage","_ref3","remove","clearCacheForPath","deleteImage","_x9","_deleteUserImage","deleteUserImage","_x0","_x1","_listUserImages","_ref4","list","paths","filter","item","_item$metadata","metadata","isDir","map","name","listUserImages","_x10","_getMultipleImages","_this","results","Promise","all","_ref5","_ref6","warn","_x12","getMultipleImages","_x11","getFileNameFromPath","pathOrUrl","includes","url","URL","pathname","pop","getUserIdFromPath","parts","optionsKey","JSON","stringify","cached","get","expiresAt","delete","_this2","set","setTimeout","keys","clearCache","clear","base64","binaryString","globalThis","atob","chars","str","i","enc1","indexOf","charAt","enc2","enc3","enc4","chr1","chr2","chr3","fromCharCode","len","bytes","Uint8Array","charCodeAt","storageService"],"sources":["storageService.ts"],"sourcesContent":["import { supabase } from '../supabase';\n\n/**\n * Interface for URL cache entries\n */\ninterface SignedUrlCacheEntry {\n  url: string;\n  expiresAt: number; // Timestamp when the URL expires\n}\n\n/**\n * Options for generating signed URLs\n */\ninterface SignedUrlOptions {\n  /** URL expiration time in seconds (default: 1 hour) */\n  expiresIn?: number;\n  /** Whether to download the file (default: false) */\n  download?: boolean;\n  /** Transform options for images */\n  transform?: {\n    width?: number;\n    height?: number;\n    quality?: number;\n    format?: 'origin' | 'webp' | 'avif' | 'jpg' | 'jpeg' | 'png';\n  };\n}\n\n/**\n * Result of storage operations\n */\ninterface StorageResult<T> {\n  data: T | null;\n  error: Error | null;\n}\n\n/**\n * Storage Service\n * Handles operations related to image storage with signed URLs\n */\nclass StorageService {\n  // Cache for signed URLs to reduce API calls\n  private signedUrlCache: Map<string, SignedUrlCacheEntry> = new Map();\n  \n  // Default bucket name\n  private readonly defaultBucket: string = 'card_images';\n  \n  // Default expiration time for signed URLs (1 hour)\n  private readonly defaultExpiresIn: number = 3600;\n  \n  // Cache buffer time in seconds (5 minutes)\n  // URLs will be refreshed 5 minutes before actual expiration\n  private readonly cacheBufferTime: number = 300;\n\n  /**\n   * Generate a signed URL for an image\n   * @param path - Path to the image in storage\n   * @param options - Options for the signed URL\n   * @returns The signed URL or null if error\n   */\n  async getSignedUrl(\n    path: string,\n    options: SignedUrlOptions = {}\n  ): Promise<StorageResult<string>> {\n    try {\n      // Check cache first\n      const cacheKey = this.getCacheKey(path, options);\n      const cachedUrl = this.getCachedUrl(cacheKey);\n      \n      if (cachedUrl) {\n        return { data: cachedUrl, error: null };\n      }\n      \n      // Set default options\n      const expiresIn = options.expiresIn || this.defaultExpiresIn;\n      \n      // Create a transform object without the format property\n      const transform = options.transform ? {\n        width: options.transform.width,\n        height: options.transform.height,\n        quality: options.transform.quality\n        // format is omitted as it's not compatible with TransformOptions\n      } : undefined;\n      \n      // Generate signed URL\n      const { data, error } = await supabase.storage\n        .from(this.defaultBucket)\n        .createSignedUrl(path, expiresIn, {\n          download: options.download || false,\n          transform\n        });\n      \n      if (error) {\n        throw error;\n      }\n      \n      if (!data?.signedUrl) {\n        throw new Error('Failed to generate signed URL');\n      }\n      \n      // Cache the URL\n      this.cacheSignedUrl(cacheKey, data.signedUrl, expiresIn);\n      \n      return { data: data.signedUrl, error: null };\n    } catch (error) {\n      console.error('Error generating signed URL:', error);\n      return { data: null, error: error instanceof Error ? error : new Error(String(error)) };\n    }\n  }\n  \n  /**\n   * Upload an image to storage\n   * @param userId - User ID for folder path\n   * @param file - File to upload (base64 string, Blob, or File)\n   * @param fileName - Optional file name (generated if not provided)\n   * @param contentType - Content type of the file\n   * @returns Path to the uploaded file or null if error\n   */\n  async uploadImage(\n    userId: string,\n    file: string | Blob | File,\n    fileName?: string,\n    contentType?: string\n  ): Promise<StorageResult<string>> {\n    try {\n      // Generate file name if not provided\n      const finalFileName = fileName || `image_${Date.now()}`;\n      \n      // Create path with user folder structure\n      const filePath = `${userId}/${finalFileName}`;\n      \n      let fileData: File | Blob | Uint8Array;\n      \n      // Handle different file types\n      if (typeof file === 'string' && file.startsWith('data:')) {\n        // Base64 data URL\n        const base64Data = file.split(',')[1];\n        fileData = this.base64ToUint8Array(base64Data);\n        \n        // Extract content type if not provided\n        if (!contentType) {\n          contentType = file.split(';')[0].split(':')[1];\n        }\n      // In React Native (and therefore in Expo) the global `File`\n      // constructor does **not** exist.  Checking for it causes a\n      // TypeScript error (`TS2358: The left-hand side of an 'instanceof'\n      // expression must be of type 'any', an object type or a type\n      // parameter`).  A `Blob` check is sufficient for RN/Expo because\n      // any binary payload (e.g. from `expo-image-picker`) is represented\n      // as a `Blob`.\n      } else if (file instanceof Blob) {\n        fileData = file;\n      } else if (typeof file === 'string') {\n        // Assume it's already base64 encoded without data URL prefix\n        fileData = this.base64ToUint8Array(file);\n      } else {\n        throw new Error('Unsupported file format');\n      }\n      \n      // Upload the file\n      const { data, error } = await supabase.storage\n        .from(this.defaultBucket)\n        .upload(filePath, fileData, {\n          contentType: contentType || 'image/jpeg',\n          upsert: true\n        });\n      \n      if (error) {\n        throw error;\n      }\n      \n      if (!data?.path) {\n        throw new Error('Upload successful but path not returned');\n      }\n      \n      return { data: data.path, error: null };\n    } catch (error) {\n      console.error('Error uploading image:', error);\n      return { data: null, error: error instanceof Error ? error : new Error(String(error)) };\n    }\n  }\n  \n  /**\n   * Get an image with a signed URL\n   * @param path - Path to the image\n   * @param options - Options for the signed URL\n   * @returns The signed URL or null if error\n   */\n  async getImage(\n    path: string,\n    options: SignedUrlOptions = {}\n  ): Promise<StorageResult<string>> {\n    return this.getSignedUrl(path, options);\n  }\n  \n  /**\n   * Get a user's image with a signed URL\n   * @param userId - User ID\n   * @param fileName - File name\n   * @param options - Options for the signed URL\n   * @returns The signed URL or null if error\n   */\n  async getUserImage(\n    userId: string,\n    fileName: string,\n    options: SignedUrlOptions = {}\n  ): Promise<StorageResult<string>> {\n    const path = `${userId}/${fileName}`;\n    return this.getSignedUrl(path, options);\n  }\n  \n  /**\n   * Delete an image from storage\n   * @param path - Path to the image\n   * @returns Success status\n   */\n  async deleteImage(path: string): Promise<StorageResult<boolean>> {\n    try {\n      const { error } = await supabase.storage\n        .from(this.defaultBucket)\n        .remove([path]);\n      \n      if (error) {\n        throw error;\n      }\n      \n      // Clear any cached URLs for this path\n      this.clearCacheForPath(path);\n      \n      return { data: true, error: null };\n    } catch (error) {\n      console.error('Error deleting image:', error);\n      return { data: null, error: error instanceof Error ? error : new Error(String(error)) };\n    }\n  }\n  \n  /**\n   * Delete a user's image from storage\n   * @param userId - User ID\n   * @param fileName - File name\n   * @returns Success status\n   */\n  async deleteUserImage(\n    userId: string,\n    fileName: string\n  ): Promise<StorageResult<boolean>> {\n    const path = `${userId}/${fileName}`;\n    return this.deleteImage(path);\n  }\n  \n  /**\n   * List all images for a user\n   * @param userId - User ID\n   * @returns List of image paths or null if error\n   */\n  async listUserImages(userId: string): Promise<StorageResult<string[]>> {\n    try {\n      const { data, error } = await supabase.storage\n        .from(this.defaultBucket)\n        .list(userId);\n      \n      if (error) {\n        throw error;\n      }\n      \n      // Extract file paths\n      const paths = data\n        .filter(item => !item.metadata?.isDir)\n        .map(item => `${userId}/${item.name}`);\n      \n      return { data: paths, error: null };\n    } catch (error) {\n      console.error('Error listing user images:', error);\n      return { data: null, error: error instanceof Error ? error : new Error(String(error)) };\n    }\n  }\n  \n  /**\n   * Get multiple images with signed URLs\n   * @param paths - Array of image paths\n   * @param options - Options for the signed URLs\n   * @returns Object mapping paths to signed URLs, or null if error\n   */\n  async getMultipleImages(\n    paths: string[],\n    options: SignedUrlOptions = {}\n  ): Promise<StorageResult<Record<string, string>>> {\n    try {\n      const results: Record<string, string> = {};\n      \n      // Process all paths in parallel\n      await Promise.all(\n        paths.map(async (path) => {\n          const { data, error } = await this.getSignedUrl(path, options);\n          \n          if (error) {\n            console.warn(`Error getting signed URL for ${path}:`, error);\n            return;\n          }\n          \n          if (data) {\n            results[path] = data;\n          }\n        })\n      );\n      \n      return { data: results, error: null };\n    } catch (error) {\n      console.error('Error getting multiple images:', error);\n      return { data: null, error: error instanceof Error ? error : new Error(String(error)) };\n    }\n  }\n  \n  /**\n   * Extract file name from a path or URL\n   * @param pathOrUrl - Path or URL to extract file name from\n   * @returns File name\n   */\n  getFileNameFromPath(pathOrUrl: string): string {\n    // Handle URLs\n    if (pathOrUrl.includes('://')) {\n      const url = new URL(pathOrUrl);\n      pathOrUrl = url.pathname;\n    }\n    \n    // Extract file name\n    return pathOrUrl.split('/').pop() || '';\n  }\n  \n  /**\n   * Extract user ID from a path\n   * @param path - Path to extract user ID from\n   * @returns User ID\n   */\n  getUserIdFromPath(path: string): string {\n    const parts = path.split('/');\n    return parts.length > 1 ? parts[0] : '';\n  }\n  \n  /**\n   * Generate a cache key for a path and options\n   * @param path - Path to the image\n   * @param options - Options for the signed URL\n   * @returns Cache key\n   */\n  private getCacheKey(path: string, options: SignedUrlOptions): string {\n    // Create a stable JSON representation of options\n    const optionsKey = JSON.stringify({\n      expiresIn: options.expiresIn || this.defaultExpiresIn,\n      download: options.download || false,\n      transform: options.transform || {}\n    });\n    \n    return `${path}:${optionsKey}`;\n  }\n  \n  /**\n   * Get a cached URL if it exists and is not expired\n   * @param cacheKey - Cache key\n   * @returns Cached URL or null if not found or expired\n   */\n  private getCachedUrl(cacheKey: string): string | null {\n    const cached = this.signedUrlCache.get(cacheKey);\n    \n    if (!cached) {\n      return null;\n    }\n    \n    // Check if the URL is about to expire (within buffer time)\n    const now = Date.now();\n    if (cached.expiresAt - now <= this.cacheBufferTime * 1000) {\n      // URL is about to expire, remove it from cache\n      this.signedUrlCache.delete(cacheKey);\n      return null;\n    }\n    \n    return cached.url;\n  }\n  \n  /**\n   * Cache a signed URL\n   * @param cacheKey - Cache key\n   * @param url - Signed URL\n   * @param expiresIn - Expiration time in seconds\n   */\n  private cacheSignedUrl(cacheKey: string, url: string, expiresIn: number): void {\n    // Calculate expiration timestamp\n    const expiresAt = Date.now() + expiresIn * 1000;\n    \n    // Store in cache\n    this.signedUrlCache.set(cacheKey, { url, expiresAt });\n    \n    // Set up automatic cache cleanup\n    setTimeout(() => {\n      this.signedUrlCache.delete(cacheKey);\n    }, (expiresIn - this.cacheBufferTime) * 1000);\n  }\n  \n  /**\n   * Clear all cached URLs for a specific path\n   * @param path - Path to clear cache for\n   */\n  private clearCacheForPath(path: string): void {\n    // Find and remove all cache entries for this path\n    for (const key of this.signedUrlCache.keys()) {\n      if (key.startsWith(`${path}:`)) {\n        this.signedUrlCache.delete(key);\n      }\n    }\n  }\n  \n  /**\n   * Clear the entire URL cache\n   */\n  clearCache(): void {\n    this.signedUrlCache.clear();\n  }\n\n  /**\n   * Convert a base-64 string to Uint8Array (React-Native friendly)\n   * @param base64 - Base-64 encoded data (without data-URI prefix)\n   */\n  private base64ToUint8Array(base64: string): Uint8Array {\n    // atob is available in React Native >= 0.64 / Expo SDK 41+. Add fallback if needed.\n    // Use atob when available (modern React-Native & Expo provide it).\n    // For environments without atob (very old RN versions), perform\n    // a manual base-64 decoding.\n    const binaryString = typeof globalThis.atob === 'function'\n      ? globalThis.atob(base64)\n      : (() => {\n          const chars =\n            'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n          let str = '';\n          let i = 0;\n          for (; i < base64.length; i += 4) {\n            const enc1 = chars.indexOf(base64.charAt(i));\n            const enc2 = chars.indexOf(base64.charAt(i + 1));\n            const enc3 = chars.indexOf(base64.charAt(i + 2));\n            const enc4 = chars.indexOf(base64.charAt(i + 3));\n\n            const chr1 = (enc1 << 2) | (enc2 >> 4);\n            const chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n            const chr3 = ((enc3 & 3) << 6) | enc4;\n\n            str += String.fromCharCode(chr1);\n            if (enc3 !== 64) str += String.fromCharCode(chr2);\n            if (enc4 !== 64) str += String.fromCharCode(chr3);\n          }\n          return str;\n        })();\n\n    const len = binaryString.length;\n    const bytes = new Uint8Array(len);\n    for (let i = 0; i < len; i++) {\n      bytes[i] = binaryString.charCodeAt(i);\n    }\n    return bytes;\n  }\n}\n\n// Export a singleton instance\nexport const storageService = new StorageService();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,QAAQ,QAAQ,aAAa;AAAC,IAuCjCC,cAAc;EAAA,SAAAA,eAAA;IAAAC,eAAA,OAAAD,cAAA;IAAA,KAEVE,cAAc,IAAAC,aAAA,GAAAC,CAAA,OAAqC,IAAIC,GAAG,CAAC,CAAC;IAAA,KAGnDC,aAAa,IAAAH,aAAA,GAAAC,CAAA,OAAW,aAAa;IAAA,KAGrCG,gBAAgB,IAAAJ,aAAA,GAAAC,CAAA,OAAW,IAAI;IAAA,KAI/BI,eAAe,IAAAL,aAAA,GAAAC,CAAA,OAAW,GAAG;EAAA;EAAA,OAAAK,YAAA,CAAAT,cAAA;IAAAU,GAAA;IAAAC,KAAA;MAAA,IAAAC,aAAA,GAAAC,iBAAA,CAQ9C,WACEC,IAAY,EAEoB;QAAA,IADhCC,OAAyB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,OAAAb,aAAA,GAAAgB,CAAA,UAAG,CAAC,CAAC;QAAAhB,aAAA,GAAAiB,CAAA;QAAAjB,aAAA,GAAAC,CAAA;QAE9B,IAAI;UAEF,IAAMiB,QAAQ,IAAAlB,aAAA,GAAAC,CAAA,OAAG,IAAI,CAACkB,WAAW,CAACR,IAAI,EAAEC,OAAO,CAAC;UAChD,IAAMQ,SAAS,IAAApB,aAAA,GAAAC,CAAA,OAAG,IAAI,CAACoB,YAAY,CAACH,QAAQ,CAAC;UAAClB,aAAA,GAAAC,CAAA;UAE9C,IAAImB,SAAS,EAAE;YAAApB,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YACb,OAAO;cAAEqB,IAAI,EAAEF,SAAS;cAAEG,KAAK,EAAE;YAAK,CAAC;UACzC,CAAC;YAAAvB,aAAA,GAAAgB,CAAA;UAAA;UAGD,IAAMQ,SAAS,IAAAxB,aAAA,GAAAC,CAAA,OAAG,CAAAD,aAAA,GAAAgB,CAAA,UAAAJ,OAAO,CAACY,SAAS,MAAAxB,aAAA,GAAAgB,CAAA,UAAI,IAAI,CAACZ,gBAAgB;UAG5D,IAAMqB,SAAS,IAAAzB,aAAA,GAAAC,CAAA,QAAGW,OAAO,CAACa,SAAS,IAAAzB,aAAA,GAAAgB,CAAA,UAAG;YACpCU,KAAK,EAAEd,OAAO,CAACa,SAAS,CAACC,KAAK;YAC9BC,MAAM,EAAEf,OAAO,CAACa,SAAS,CAACE,MAAM;YAChCC,OAAO,EAAEhB,OAAO,CAACa,SAAS,CAACG;UAE7B,CAAC,KAAA5B,aAAA,GAAAgB,CAAA,UAAGD,SAAS;UAGb,IAAAc,IAAA,IAAA7B,aAAA,GAAAC,CAAA,cAA8BL,QAAQ,CAACkC,OAAO,CAC3CC,IAAI,CAAC,IAAI,CAAC5B,aAAa,CAAC,CACxB6B,eAAe,CAACrB,IAAI,EAAEa,SAAS,EAAE;cAChCS,QAAQ,EAAE,CAAAjC,aAAA,GAAAgB,CAAA,UAAAJ,OAAO,CAACqB,QAAQ,MAAAjC,aAAA,GAAAgB,CAAA,UAAI,KAAK;cACnCS,SAAS,EAATA;YACF,CAAC,CAAC;YALIH,IAAI,GAAAO,IAAA,CAAJP,IAAI;YAAEC,KAAK,GAAAM,IAAA,CAALN,KAAK;UAKdvB,aAAA,GAAAC,CAAA;UAEL,IAAIsB,KAAK,EAAE;YAAAvB,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YACT,MAAMsB,KAAK;UACb,CAAC;YAAAvB,aAAA,GAAAgB,CAAA;UAAA;UAAAhB,aAAA,GAAAC,CAAA;UAED,IAAI,EAACqB,IAAI,YAAJA,IAAI,CAAEY,SAAS,GAAE;YAAAlC,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YACpB,MAAM,IAAIkC,KAAK,CAAC,+BAA+B,CAAC;UAClD,CAAC;YAAAnC,aAAA,GAAAgB,CAAA;UAAA;UAAAhB,aAAA,GAAAC,CAAA;UAGD,IAAI,CAACmC,cAAc,CAAClB,QAAQ,EAAEI,IAAI,CAACY,SAAS,EAAEV,SAAS,CAAC;UAACxB,aAAA,GAAAC,CAAA;UAEzD,OAAO;YAAEqB,IAAI,EAAEA,IAAI,CAACY,SAAS;YAAEX,KAAK,EAAE;UAAK,CAAC;QAC9C,CAAC,CAAC,OAAOA,KAAK,EAAE;UAAAvB,aAAA,GAAAC,CAAA;UACdoC,OAAO,CAACd,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;UAACvB,aAAA,GAAAC,CAAA;UACrD,OAAO;YAAEqB,IAAI,EAAE,IAAI;YAAEC,KAAK,EAAEA,KAAK,YAAYY,KAAK,IAAAnC,aAAA,GAAAgB,CAAA,UAAGO,KAAK,KAAAvB,aAAA,GAAAgB,CAAA,UAAG,IAAImB,KAAK,CAACG,MAAM,CAACf,KAAK,CAAC,CAAC;UAAC,CAAC;QACzF;MACF,CAAC;MAAA,SAhDKgB,YAAYA,CAAAC,EAAA;QAAA,OAAA/B,aAAA,CAAAgC,KAAA,OAAA5B,SAAA;MAAA;MAAA,OAAZ0B,YAAY;IAAA;EAAA;IAAAhC,GAAA;IAAAC,KAAA;MAAA,IAAAkC,YAAA,GAAAhC,iBAAA,CA0DlB,WACEiC,MAAc,EACdC,IAA0B,EAC1BC,QAAiB,EACjBC,WAAoB,EACY;QAAA9C,aAAA,GAAAiB,CAAA;QAAAjB,aAAA,GAAAC,CAAA;QAChC,IAAI;UAEF,IAAM8C,aAAa,IAAA/C,aAAA,GAAAC,CAAA,QAAG,CAAAD,aAAA,GAAAgB,CAAA,UAAA6B,QAAQ,MAAA7C,aAAA,GAAAgB,CAAA,UAAI,SAASgC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;UAGvD,IAAMC,QAAQ,IAAAlD,aAAA,GAAAC,CAAA,QAAG,GAAG0C,MAAM,IAAII,aAAa,EAAE;UAE7C,IAAII,QAAkC;UAACnD,aAAA,GAAAC,CAAA;UAGvC,IAAI,CAAAD,aAAA,GAAAgB,CAAA,kBAAO4B,IAAI,KAAK,QAAQ,MAAA5C,aAAA,GAAAgB,CAAA,WAAI4B,IAAI,CAACQ,UAAU,CAAC,OAAO,CAAC,GAAE;YAAApD,aAAA,GAAAgB,CAAA;YAExD,IAAMqC,UAAU,IAAArD,aAAA,GAAAC,CAAA,QAAG2C,IAAI,CAACU,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YAACtD,aAAA,GAAAC,CAAA;YACtCkD,QAAQ,GAAG,IAAI,CAACI,kBAAkB,CAACF,UAAU,CAAC;YAACrD,aAAA,GAAAC,CAAA;YAG/C,IAAI,CAAC6C,WAAW,EAAE;cAAA9C,aAAA,GAAAgB,CAAA;cAAAhB,aAAA,GAAAC,CAAA;cAChB6C,WAAW,GAAGF,IAAI,CAACU,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAACA,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YAChD,CAAC;cAAAtD,aAAA,GAAAgB,CAAA;YAAA;UAQH,CAAC,MAAM;YAAAhB,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YAAA,IAAI2C,IAAI,YAAYY,IAAI,EAAE;cAAAxD,aAAA,GAAAgB,CAAA;cAAAhB,aAAA,GAAAC,CAAA;cAC/BkD,QAAQ,GAAGP,IAAI;YACjB,CAAC,MAAM;cAAA5C,aAAA,GAAAgB,CAAA;cAAAhB,aAAA,GAAAC,CAAA;cAAA,IAAI,OAAO2C,IAAI,KAAK,QAAQ,EAAE;gBAAA5C,aAAA,GAAAgB,CAAA;gBAAAhB,aAAA,GAAAC,CAAA;gBAEnCkD,QAAQ,GAAG,IAAI,CAACI,kBAAkB,CAACX,IAAI,CAAC;cAC1C,CAAC,MAAM;gBAAA5C,aAAA,GAAAgB,CAAA;gBAAAhB,aAAA,GAAAC,CAAA;gBACL,MAAM,IAAIkC,KAAK,CAAC,yBAAyB,CAAC;cAC5C;YAAA;UAAA;UAGA,IAAAsB,KAAA,IAAAzD,aAAA,GAAAC,CAAA,cAA8BL,QAAQ,CAACkC,OAAO,CAC3CC,IAAI,CAAC,IAAI,CAAC5B,aAAa,CAAC,CACxBuD,MAAM,CAACR,QAAQ,EAAEC,QAAQ,EAAE;cAC1BL,WAAW,EAAE,CAAA9C,aAAA,GAAAgB,CAAA,WAAA8B,WAAW,MAAA9C,aAAA,GAAAgB,CAAA,WAAI,YAAY;cACxC2C,MAAM,EAAE;YACV,CAAC,CAAC;YALIrC,IAAI,GAAAmC,KAAA,CAAJnC,IAAI;YAAEC,KAAK,GAAAkC,KAAA,CAALlC,KAAK;UAKdvB,aAAA,GAAAC,CAAA;UAEL,IAAIsB,KAAK,EAAE;YAAAvB,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YACT,MAAMsB,KAAK;UACb,CAAC;YAAAvB,aAAA,GAAAgB,CAAA;UAAA;UAAAhB,aAAA,GAAAC,CAAA;UAED,IAAI,EAACqB,IAAI,YAAJA,IAAI,CAAEX,IAAI,GAAE;YAAAX,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YACf,MAAM,IAAIkC,KAAK,CAAC,yCAAyC,CAAC;UAC5D,CAAC;YAAAnC,aAAA,GAAAgB,CAAA;UAAA;UAAAhB,aAAA,GAAAC,CAAA;UAED,OAAO;YAAEqB,IAAI,EAAEA,IAAI,CAACX,IAAI;YAAEY,KAAK,EAAE;UAAK,CAAC;QACzC,CAAC,CAAC,OAAOA,KAAK,EAAE;UAAAvB,aAAA,GAAAC,CAAA;UACdoC,OAAO,CAACd,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;UAACvB,aAAA,GAAAC,CAAA;UAC/C,OAAO;YAAEqB,IAAI,EAAE,IAAI;YAAEC,KAAK,EAAEA,KAAK,YAAYY,KAAK,IAAAnC,aAAA,GAAAgB,CAAA,WAAGO,KAAK,KAAAvB,aAAA,GAAAgB,CAAA,WAAG,IAAImB,KAAK,CAACG,MAAM,CAACf,KAAK,CAAC,CAAC;UAAC,CAAC;QACzF;MACF,CAAC;MAAA,SA9DKqC,WAAWA,CAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA;QAAA,OAAAtB,YAAA,CAAAD,KAAA,OAAA5B,SAAA;MAAA;MAAA,OAAX+C,WAAW;IAAA;EAAA;IAAArD,GAAA;IAAAC,KAAA;MAAA,IAAAyD,SAAA,GAAAvD,iBAAA,CAsEjB,WACEC,IAAY,EAEoB;QAAA,IADhCC,OAAyB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,OAAAb,aAAA,GAAAgB,CAAA,WAAG,CAAC,CAAC;QAAAhB,aAAA,GAAAiB,CAAA;QAAAjB,aAAA,GAAAC,CAAA;QAE9B,OAAO,IAAI,CAACsC,YAAY,CAAC5B,IAAI,EAAEC,OAAO,CAAC;MACzC,CAAC;MAAA,SALKsD,QAAQA,CAAAC,GAAA;QAAA,OAAAF,SAAA,CAAAxB,KAAA,OAAA5B,SAAA;MAAA;MAAA,OAARqD,QAAQ;IAAA;EAAA;IAAA3D,GAAA;IAAAC,KAAA;MAAA,IAAA4D,aAAA,GAAA1D,iBAAA,CAcd,WACEiC,MAAc,EACdE,QAAgB,EAEgB;QAAA,IADhCjC,OAAyB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,OAAAb,aAAA,GAAAgB,CAAA,WAAG,CAAC,CAAC;QAAAhB,aAAA,GAAAiB,CAAA;QAE9B,IAAMN,IAAI,IAAAX,aAAA,GAAAC,CAAA,QAAG,GAAG0C,MAAM,IAAIE,QAAQ,EAAE;QAAC7C,aAAA,GAAAC,CAAA;QACrC,OAAO,IAAI,CAACsC,YAAY,CAAC5B,IAAI,EAAEC,OAAO,CAAC;MACzC,CAAC;MAAA,SAPKyD,YAAYA,CAAAC,GAAA,EAAAC,GAAA;QAAA,OAAAH,aAAA,CAAA3B,KAAA,OAAA5B,SAAA;MAAA;MAAA,OAAZwD,YAAY;IAAA;EAAA;IAAA9D,GAAA;IAAAC,KAAA;MAAA,IAAAgE,YAAA,GAAA9D,iBAAA,CAclB,WAAkBC,IAAY,EAAmC;QAAAX,aAAA,GAAAiB,CAAA;QAAAjB,aAAA,GAAAC,CAAA;QAC/D,IAAI;UACF,IAAAwE,KAAA,IAAAzE,aAAA,GAAAC,CAAA,cAAwBL,QAAQ,CAACkC,OAAO,CACrCC,IAAI,CAAC,IAAI,CAAC5B,aAAa,CAAC,CACxBuE,MAAM,CAAC,CAAC/D,IAAI,CAAC,CAAC;YAFTY,KAAK,GAAAkD,KAAA,CAALlD,KAAK;UAEKvB,aAAA,GAAAC,CAAA;UAElB,IAAIsB,KAAK,EAAE;YAAAvB,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YACT,MAAMsB,KAAK;UACb,CAAC;YAAAvB,aAAA,GAAAgB,CAAA;UAAA;UAAAhB,aAAA,GAAAC,CAAA;UAGD,IAAI,CAAC0E,iBAAiB,CAAChE,IAAI,CAAC;UAACX,aAAA,GAAAC,CAAA;UAE7B,OAAO;YAAEqB,IAAI,EAAE,IAAI;YAAEC,KAAK,EAAE;UAAK,CAAC;QACpC,CAAC,CAAC,OAAOA,KAAK,EAAE;UAAAvB,aAAA,GAAAC,CAAA;UACdoC,OAAO,CAACd,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;UAACvB,aAAA,GAAAC,CAAA;UAC9C,OAAO;YAAEqB,IAAI,EAAE,IAAI;YAAEC,KAAK,EAAEA,KAAK,YAAYY,KAAK,IAAAnC,aAAA,GAAAgB,CAAA,WAAGO,KAAK,KAAAvB,aAAA,GAAAgB,CAAA,WAAG,IAAImB,KAAK,CAACG,MAAM,CAACf,KAAK,CAAC,CAAC;UAAC,CAAC;QACzF;MACF,CAAC;MAAA,SAlBKqD,WAAWA,CAAAC,GAAA;QAAA,OAAAL,YAAA,CAAA/B,KAAA,OAAA5B,SAAA;MAAA;MAAA,OAAX+D,WAAW;IAAA;EAAA;IAAArE,GAAA;IAAAC,KAAA;MAAA,IAAAsE,gBAAA,GAAApE,iBAAA,CA0BjB,WACEiC,MAAc,EACdE,QAAgB,EACiB;QAAA7C,aAAA,GAAAiB,CAAA;QACjC,IAAMN,IAAI,IAAAX,aAAA,GAAAC,CAAA,QAAG,GAAG0C,MAAM,IAAIE,QAAQ,EAAE;QAAC7C,aAAA,GAAAC,CAAA;QACrC,OAAO,IAAI,CAAC2E,WAAW,CAACjE,IAAI,CAAC;MAC/B,CAAC;MAAA,SANKoE,eAAeA,CAAAC,GAAA,EAAAC,GAAA;QAAA,OAAAH,gBAAA,CAAArC,KAAA,OAAA5B,SAAA;MAAA;MAAA,OAAfkE,eAAe;IAAA;EAAA;IAAAxE,GAAA;IAAAC,KAAA;MAAA,IAAA0E,eAAA,GAAAxE,iBAAA,CAarB,WAAqBiC,MAAc,EAAoC;QAAA3C,aAAA,GAAAiB,CAAA;QAAAjB,aAAA,GAAAC,CAAA;QACrE,IAAI;UACF,IAAAkF,KAAA,IAAAnF,aAAA,GAAAC,CAAA,cAA8BL,QAAQ,CAACkC,OAAO,CAC3CC,IAAI,CAAC,IAAI,CAAC5B,aAAa,CAAC,CACxBiF,IAAI,CAACzC,MAAM,CAAC;YAFPrB,IAAI,GAAA6D,KAAA,CAAJ7D,IAAI;YAAEC,KAAK,GAAA4D,KAAA,CAAL5D,KAAK;UAEHvB,aAAA,GAAAC,CAAA;UAEhB,IAAIsB,KAAK,EAAE;YAAAvB,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YACT,MAAMsB,KAAK;UACb,CAAC;YAAAvB,aAAA,GAAAgB,CAAA;UAAA;UAGD,IAAMqE,KAAK,IAAArF,aAAA,GAAAC,CAAA,QAAGqB,IAAI,CACfgE,MAAM,CAAC,UAAAC,IAAI,EAAI;YAAA,IAAAC,cAAA;YAAAxF,aAAA,GAAAiB,CAAA;YAAAjB,aAAA,GAAAC,CAAA;YAAA,UAAAuF,cAAA,GAACD,IAAI,CAACE,QAAQ,aAAbD,cAAA,CAAeE,KAAK;UAAD,CAAC,CAAC,CACrCC,GAAG,CAAC,UAAAJ,IAAI,EAAI;YAAAvF,aAAA,GAAAiB,CAAA;YAAAjB,aAAA,GAAAC,CAAA;YAAA,UAAG0C,MAAM,IAAI4C,IAAI,CAACK,IAAI,EAAE;UAAD,CAAC,CAAC;UAAC5F,aAAA,GAAAC,CAAA;UAEzC,OAAO;YAAEqB,IAAI,EAAE+D,KAAK;YAAE9D,KAAK,EAAE;UAAK,CAAC;QACrC,CAAC,CAAC,OAAOA,KAAK,EAAE;UAAAvB,aAAA,GAAAC,CAAA;UACdoC,OAAO,CAACd,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;UAACvB,aAAA,GAAAC,CAAA;UACnD,OAAO;YAAEqB,IAAI,EAAE,IAAI;YAAEC,KAAK,EAAEA,KAAK,YAAYY,KAAK,IAAAnC,aAAA,GAAAgB,CAAA,WAAGO,KAAK,KAAAvB,aAAA,GAAAgB,CAAA,WAAG,IAAImB,KAAK,CAACG,MAAM,CAACf,KAAK,CAAC,CAAC;UAAC,CAAC;QACzF;MACF,CAAC;MAAA,SApBKsE,cAAcA,CAAAC,IAAA;QAAA,OAAAZ,eAAA,CAAAzC,KAAA,OAAA5B,SAAA;MAAA;MAAA,OAAdgF,cAAc;IAAA;EAAA;IAAAtF,GAAA;IAAAC,KAAA;MAAA,IAAAuF,kBAAA,GAAArF,iBAAA,CA4BpB,WACE2E,KAAe,EAEiC;QAAA,IAAAW,KAAA;QAAA,IADhDpF,OAAyB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,OAAAb,aAAA,GAAAgB,CAAA,WAAG,CAAC,CAAC;QAAAhB,aAAA,GAAAiB,CAAA;QAAAjB,aAAA,GAAAC,CAAA;QAE9B,IAAI;UACF,IAAMgG,OAA+B,IAAAjG,aAAA,GAAAC,CAAA,QAAG,CAAC,CAAC;UAACD,aAAA,GAAAC,CAAA;UAG3C,MAAMiG,OAAO,CAACC,GAAG,CACfd,KAAK,CAACM,GAAG;YAAA,IAAAS,KAAA,GAAA1F,iBAAA,CAAC,WAAOC,IAAI,EAAK;cAAAX,aAAA,GAAAiB,CAAA;cACxB,IAAAoF,KAAA,IAAArG,aAAA,GAAAC,CAAA,cAA8B+F,KAAI,CAACzD,YAAY,CAAC5B,IAAI,EAAEC,OAAO,CAAC;gBAAtDU,IAAI,GAAA+E,KAAA,CAAJ/E,IAAI;gBAAEC,KAAK,GAAA8E,KAAA,CAAL9E,KAAK;cAA4CvB,aAAA,GAAAC,CAAA;cAE/D,IAAIsB,KAAK,EAAE;gBAAAvB,aAAA,GAAAgB,CAAA;gBAAAhB,aAAA,GAAAC,CAAA;gBACToC,OAAO,CAACiE,IAAI,CAAC,gCAAgC3F,IAAI,GAAG,EAAEY,KAAK,CAAC;gBAACvB,aAAA,GAAAC,CAAA;gBAC7D;cACF,CAAC;gBAAAD,aAAA,GAAAgB,CAAA;cAAA;cAAAhB,aAAA,GAAAC,CAAA;cAED,IAAIqB,IAAI,EAAE;gBAAAtB,aAAA,GAAAgB,CAAA;gBAAAhB,aAAA,GAAAC,CAAA;gBACRgG,OAAO,CAACtF,IAAI,CAAC,GAAGW,IAAI;cACtB,CAAC;gBAAAtB,aAAA,GAAAgB,CAAA;cAAA;YACH,CAAC;YAAA,iBAAAuF,IAAA;cAAA,OAAAH,KAAA,CAAA3D,KAAA,OAAA5B,SAAA;YAAA;UAAA,IACH,CAAC;UAACb,aAAA,GAAAC,CAAA;UAEF,OAAO;YAAEqB,IAAI,EAAE2E,OAAO;YAAE1E,KAAK,EAAE;UAAK,CAAC;QACvC,CAAC,CAAC,OAAOA,KAAK,EAAE;UAAAvB,aAAA,GAAAC,CAAA;UACdoC,OAAO,CAACd,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;UAACvB,aAAA,GAAAC,CAAA;UACvD,OAAO;YAAEqB,IAAI,EAAE,IAAI;YAAEC,KAAK,EAAEA,KAAK,YAAYY,KAAK,IAAAnC,aAAA,GAAAgB,CAAA,WAAGO,KAAK,KAAAvB,aAAA,GAAAgB,CAAA,WAAG,IAAImB,KAAK,CAACG,MAAM,CAACf,KAAK,CAAC,CAAC;UAAC,CAAC;QACzF;MACF,CAAC;MAAA,SA5BKiF,iBAAiBA,CAAAC,IAAA;QAAA,OAAAV,kBAAA,CAAAtD,KAAA,OAAA5B,SAAA;MAAA;MAAA,OAAjB2F,iBAAiB;IAAA;EAAA;IAAAjG,GAAA;IAAAC,KAAA,EAmCvB,SAAAkG,mBAAmBA,CAACC,SAAiB,EAAU;MAAA3G,aAAA,GAAAiB,CAAA;MAAAjB,aAAA,GAAAC,CAAA;MAE7C,IAAI0G,SAAS,CAACC,QAAQ,CAAC,KAAK,CAAC,EAAE;QAAA5G,aAAA,GAAAgB,CAAA;QAC7B,IAAM6F,GAAG,IAAA7G,aAAA,GAAAC,CAAA,QAAG,IAAI6G,GAAG,CAACH,SAAS,CAAC;QAAC3G,aAAA,GAAAC,CAAA;QAC/B0G,SAAS,GAAGE,GAAG,CAACE,QAAQ;MAC1B,CAAC;QAAA/G,aAAA,GAAAgB,CAAA;MAAA;MAAAhB,aAAA,GAAAC,CAAA;MAGD,OAAO,CAAAD,aAAA,GAAAgB,CAAA,WAAA2F,SAAS,CAACrD,KAAK,CAAC,GAAG,CAAC,CAAC0D,GAAG,CAAC,CAAC,MAAAhH,aAAA,GAAAgB,CAAA,WAAI,EAAE;IACzC;EAAC;IAAAT,GAAA;IAAAC,KAAA,EAOD,SAAAyG,iBAAiBA,CAACtG,IAAY,EAAU;MAAAX,aAAA,GAAAiB,CAAA;MACtC,IAAMiG,KAAK,IAAAlH,aAAA,GAAAC,CAAA,QAAGU,IAAI,CAAC2C,KAAK,CAAC,GAAG,CAAC;MAACtD,aAAA,GAAAC,CAAA;MAC9B,OAAOiH,KAAK,CAACpG,MAAM,GAAG,CAAC,IAAAd,aAAA,GAAAgB,CAAA,WAAGkG,KAAK,CAAC,CAAC,CAAC,KAAAlH,aAAA,GAAAgB,CAAA,WAAG,EAAE;IACzC;EAAC;IAAAT,GAAA;IAAAC,KAAA,EAQD,SAAQW,WAAWA,CAACR,IAAY,EAAEC,OAAyB,EAAU;MAAAZ,aAAA,GAAAiB,CAAA;MAEnE,IAAMkG,UAAU,IAAAnH,aAAA,GAAAC,CAAA,QAAGmH,IAAI,CAACC,SAAS,CAAC;QAChC7F,SAAS,EAAE,CAAAxB,aAAA,GAAAgB,CAAA,WAAAJ,OAAO,CAACY,SAAS,MAAAxB,aAAA,GAAAgB,CAAA,WAAI,IAAI,CAACZ,gBAAgB;QACrD6B,QAAQ,EAAE,CAAAjC,aAAA,GAAAgB,CAAA,WAAAJ,OAAO,CAACqB,QAAQ,MAAAjC,aAAA,GAAAgB,CAAA,WAAI,KAAK;QACnCS,SAAS,EAAE,CAAAzB,aAAA,GAAAgB,CAAA,WAAAJ,OAAO,CAACa,SAAS,MAAAzB,aAAA,GAAAgB,CAAA,WAAI,CAAC,CAAC;MACpC,CAAC,CAAC;MAAChB,aAAA,GAAAC,CAAA;MAEH,OAAO,GAAGU,IAAI,IAAIwG,UAAU,EAAE;IAChC;EAAC;IAAA5G,GAAA;IAAAC,KAAA,EAOD,SAAQa,YAAYA,CAACH,QAAgB,EAAiB;MAAAlB,aAAA,GAAAiB,CAAA;MACpD,IAAMqG,MAAM,IAAAtH,aAAA,GAAAC,CAAA,QAAG,IAAI,CAACF,cAAc,CAACwH,GAAG,CAACrG,QAAQ,CAAC;MAAClB,aAAA,GAAAC,CAAA;MAEjD,IAAI,CAACqH,MAAM,EAAE;QAAAtH,aAAA,GAAAgB,CAAA;QAAAhB,aAAA,GAAAC,CAAA;QACX,OAAO,IAAI;MACb,CAAC;QAAAD,aAAA,GAAAgB,CAAA;MAAA;MAGD,IAAMiC,GAAG,IAAAjD,aAAA,GAAAC,CAAA,QAAG+C,IAAI,CAACC,GAAG,CAAC,CAAC;MAACjD,aAAA,GAAAC,CAAA;MACvB,IAAIqH,MAAM,CAACE,SAAS,GAAGvE,GAAG,IAAI,IAAI,CAAC5C,eAAe,GAAG,IAAI,EAAE;QAAAL,aAAA,GAAAgB,CAAA;QAAAhB,aAAA,GAAAC,CAAA;QAEzD,IAAI,CAACF,cAAc,CAAC0H,MAAM,CAACvG,QAAQ,CAAC;QAAClB,aAAA,GAAAC,CAAA;QACrC,OAAO,IAAI;MACb,CAAC;QAAAD,aAAA,GAAAgB,CAAA;MAAA;MAAAhB,aAAA,GAAAC,CAAA;MAED,OAAOqH,MAAM,CAACT,GAAG;IACnB;EAAC;IAAAtG,GAAA;IAAAC,KAAA,EAQD,SAAQ4B,cAAcA,CAAClB,QAAgB,EAAE2F,GAAW,EAAErF,SAAiB,EAAQ;MAAA,IAAAkG,MAAA;MAAA1H,aAAA,GAAAiB,CAAA;MAE7E,IAAMuG,SAAS,IAAAxH,aAAA,GAAAC,CAAA,QAAG+C,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGzB,SAAS,GAAG,IAAI;MAACxB,aAAA,GAAAC,CAAA;MAGhD,IAAI,CAACF,cAAc,CAAC4H,GAAG,CAACzG,QAAQ,EAAE;QAAE2F,GAAG,EAAHA,GAAG;QAAEW,SAAS,EAATA;MAAU,CAAC,CAAC;MAACxH,aAAA,GAAAC,CAAA;MAGtD2H,UAAU,CAAC,YAAM;QAAA5H,aAAA,GAAAiB,CAAA;QAAAjB,aAAA,GAAAC,CAAA;QACfyH,MAAI,CAAC3H,cAAc,CAAC0H,MAAM,CAACvG,QAAQ,CAAC;MACtC,CAAC,EAAE,CAACM,SAAS,GAAG,IAAI,CAACnB,eAAe,IAAI,IAAI,CAAC;IAC/C;EAAC;IAAAE,GAAA;IAAAC,KAAA,EAMD,SAAQmE,iBAAiBA,CAAChE,IAAY,EAAQ;MAAAX,aAAA,GAAAiB,CAAA;MAAAjB,aAAA,GAAAC,CAAA;MAE5C,KAAK,IAAMM,GAAG,IAAI,IAAI,CAACR,cAAc,CAAC8H,IAAI,CAAC,CAAC,EAAE;QAAA7H,aAAA,GAAAC,CAAA;QAC5C,IAAIM,GAAG,CAAC6C,UAAU,CAAC,GAAGzC,IAAI,GAAG,CAAC,EAAE;UAAAX,aAAA,GAAAgB,CAAA;UAAAhB,aAAA,GAAAC,CAAA;UAC9B,IAAI,CAACF,cAAc,CAAC0H,MAAM,CAAClH,GAAG,CAAC;QACjC,CAAC;UAAAP,aAAA,GAAAgB,CAAA;QAAA;MACH;IACF;EAAC;IAAAT,GAAA;IAAAC,KAAA,EAKD,SAAAsH,UAAUA,CAAA,EAAS;MAAA9H,aAAA,GAAAiB,CAAA;MAAAjB,aAAA,GAAAC,CAAA;MACjB,IAAI,CAACF,cAAc,CAACgI,KAAK,CAAC,CAAC;IAC7B;EAAC;IAAAxH,GAAA;IAAAC,KAAA,EAMD,SAAQ+C,kBAAkBA,CAACyE,MAAc,EAAc;MAAAhI,aAAA,GAAAiB,CAAA;MAKrD,IAAMgH,YAAY,IAAAjI,aAAA,GAAAC,CAAA,SAAG,OAAOiI,UAAU,CAACC,IAAI,KAAK,UAAU,IAAAnI,aAAA,GAAAgB,CAAA,WACtDkH,UAAU,CAACC,IAAI,CAACH,MAAM,CAAC,KAAAhI,aAAA,GAAAgB,CAAA,WACtB,YAAM;QAAAhB,aAAA,GAAAiB,CAAA;QACL,IAAMmH,KAAK,IAAApI,aAAA,GAAAC,CAAA,SACT,mEAAmE;QACrE,IAAIoI,GAAG,IAAArI,aAAA,GAAAC,CAAA,SAAG,EAAE;QACZ,IAAIqI,CAAC,IAAAtI,aAAA,GAAAC,CAAA,SAAG,CAAC;QAACD,aAAA,GAAAC,CAAA;QACV,OAAOqI,CAAC,GAAGN,MAAM,CAAClH,MAAM,EAAEwH,CAAC,IAAI,CAAC,EAAE;UAChC,IAAMC,IAAI,IAAAvI,aAAA,GAAAC,CAAA,SAAGmI,KAAK,CAACI,OAAO,CAACR,MAAM,CAACS,MAAM,CAACH,CAAC,CAAC,CAAC;UAC5C,IAAMI,IAAI,IAAA1I,aAAA,GAAAC,CAAA,SAAGmI,KAAK,CAACI,OAAO,CAACR,MAAM,CAACS,MAAM,CAACH,CAAC,GAAG,CAAC,CAAC,CAAC;UAChD,IAAMK,IAAI,IAAA3I,aAAA,GAAAC,CAAA,SAAGmI,KAAK,CAACI,OAAO,CAACR,MAAM,CAACS,MAAM,CAACH,CAAC,GAAG,CAAC,CAAC,CAAC;UAChD,IAAMM,IAAI,IAAA5I,aAAA,GAAAC,CAAA,SAAGmI,KAAK,CAACI,OAAO,CAACR,MAAM,CAACS,MAAM,CAACH,CAAC,GAAG,CAAC,CAAC,CAAC;UAEhD,IAAMO,IAAI,IAAA7I,aAAA,GAAAC,CAAA,SAAIsI,IAAI,IAAI,CAAC,GAAKG,IAAI,IAAI,CAAE;UACtC,IAAMI,IAAI,IAAA9I,aAAA,GAAAC,CAAA,SAAI,CAACyI,IAAI,GAAG,EAAE,KAAK,CAAC,GAAKC,IAAI,IAAI,CAAE;UAC7C,IAAMI,IAAI,IAAA/I,aAAA,GAAAC,CAAA,SAAI,CAAC0I,IAAI,GAAG,CAAC,KAAK,CAAC,GAAIC,IAAI;UAAC5I,aAAA,GAAAC,CAAA;UAEtCoI,GAAG,IAAI/F,MAAM,CAAC0G,YAAY,CAACH,IAAI,CAAC;UAAC7I,aAAA,GAAAC,CAAA;UACjC,IAAI0I,IAAI,KAAK,EAAE,EAAE;YAAA3I,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YAAAoI,GAAG,IAAI/F,MAAM,CAAC0G,YAAY,CAACF,IAAI,CAAC;UAAA,CAAC;YAAA9I,aAAA,GAAAgB,CAAA;UAAA;UAAAhB,aAAA,GAAAC,CAAA;UAClD,IAAI2I,IAAI,KAAK,EAAE,EAAE;YAAA5I,aAAA,GAAAgB,CAAA;YAAAhB,aAAA,GAAAC,CAAA;YAAAoI,GAAG,IAAI/F,MAAM,CAAC0G,YAAY,CAACD,IAAI,CAAC;UAAA,CAAC;YAAA/I,aAAA,GAAAgB,CAAA;UAAA;QACpD;QAAChB,aAAA,GAAAC,CAAA;QACD,OAAOoI,GAAG;MACZ,CAAC,CAAE,CAAC;MAER,IAAMY,GAAG,IAAAjJ,aAAA,GAAAC,CAAA,SAAGgI,YAAY,CAACnH,MAAM;MAC/B,IAAMoI,KAAK,IAAAlJ,aAAA,GAAAC,CAAA,SAAG,IAAIkJ,UAAU,CAACF,GAAG,CAAC;MAACjJ,aAAA,GAAAC,CAAA;MAClC,KAAK,IAAIqI,CAAC,IAAAtI,aAAA,GAAAC,CAAA,SAAG,CAAC,GAAEqI,CAAC,GAAGW,GAAG,EAAEX,CAAC,EAAE,EAAE;QAAAtI,aAAA,GAAAC,CAAA;QAC5BiJ,KAAK,CAACZ,CAAC,CAAC,GAAGL,YAAY,CAACmB,UAAU,CAACd,CAAC,CAAC;MACvC;MAACtI,aAAA,GAAAC,CAAA;MACD,OAAOiJ,KAAK;IACd;EAAC;AAAA;AAIH,OAAO,IAAMG,cAAc,IAAArJ,aAAA,GAAAC,CAAA,SAAG,IAAIJ,cAAc,CAAC,CAAC","ignoreList":[]}