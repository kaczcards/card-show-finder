{"version":3,"names":["supabase","MFAService","_ref","_classCallCheck","cov_7p9bcyhz4","f","supabaseUrl","s","b","url","baseUrl","replace","_createClass","key","value","_startEnrollment","_asyncToGenerator","_ref2","callMFAEndpoint","data","error","Error","message","err","console","startEnrollment","apply","arguments","_verifySetup","code","challengeId","_ref3","verifySetup","_x","_x2","_authenticate","userId","sessionId","_ref4","authenticate","_x3","_x4","_x5","_validateRecoveryCode","_ref5","validateRecoveryCode","_x6","_x7","_x8","_disableMFA","_ref6","disableMFA","_x9","_getMFAStatus","_ref7","getMFAStatus","_regenerateRecoveryCodes","_ref8","regenerateRecoveryCodes","_x0","_isMFARequired","_ref9","from","select","eq","single","profile","mfa_enabled","mfa_verified","isMFARequired","_x1","_callMFAEndpoint","endpoint","body","length","undefined","method","_ref0","auth","getSession","session","headers","access_token","response","fetch","JSON","stringify","ok","errorData","json","status","_x10","mfaService"],"sources":["mfaService.ts"],"sourcesContent":["import { supabase } from '../supabase';\n\n/**\n * MFA enrollment response\n */\nexport interface MFAEnrollmentResponse {\n  secret: string;\n  qrCode: string;\n  challengeId: string;\n  algorithm: string;\n  digits: number;\n  period: number;\n}\n\n/**\n * MFA verification response\n */\nexport interface MFAVerificationResponse {\n  success: boolean;\n  recoveryCodes: string[];\n  message: string;\n}\n\n/**\n * MFA authentication response\n */\nexport interface MFAAuthenticationResponse {\n  success: boolean;\n  message: string;\n  sessionId?: string;\n}\n\n/**\n * MFA recovery code validation response\n */\nexport interface MFARecoveryResponse {\n  success: boolean;\n  message: string;\n  sessionId?: string;\n  recoveryCodesRemaining: number;\n}\n\n/**\n * MFA status response\n */\nexport interface MFAStatusResponse {\n  mfaEnabled: boolean;\n  mfaVerified: boolean;\n  enrollmentTime: string | null;\n  recoveryCodesRemaining: number;\n}\n\n/**\n * MFA service for managing Multi-Factor Authentication\n */\nexport class MFAService {\n  private readonly baseUrl: string;\n\n  /**\n   * Constructor\n   */\n  constructor() {\n    // Get the base Supabase URL from the client (public property).\n    // We cast to `any` to avoid TypeScript complaining about protected members.\n    const supabaseUrl: string = (supabase as any).url ?? \"\";\n    // Replace the auth part with functions\n    this.baseUrl = supabaseUrl.replace(\"/auth/v1\", \"/functions/v1/mfa\");\n  }\n\n  /**\n   * Start MFA enrollment process\n   * @returns MFA enrollment data including secret and QR code\n   */\n  async startEnrollment(): Promise<MFAEnrollmentResponse> {\n    try {\n      const { data, error } = await this.callMFAEndpoint<MFAEnrollmentResponse>(\"enroll\", {}, \"GET\");\n      if (error) {\n        throw new Error(error.message);\n      }\n      \n      return data;\n    } catch (err) {\n      console.error(\"Failed to start MFA enrollment:\", err);\n      throw err;\n    }\n  }\n\n  /**\n   * Verify MFA setup with a TOTP code\n   * @param code - The TOTP code from the authenticator app\n   * @param challengeId - The challenge ID from enrollment\n   * @returns Verification result with recovery codes\n   */\n  async verifySetup(code: string, challengeId: string): Promise<MFAVerificationResponse> {\n    try {\n      const { data, error } = await this.callMFAEndpoint<MFAVerificationResponse>(\"verify\", {\n        code,\n        challengeId\n      });\n      if (error) {\n        throw new Error(error.message);\n      }\n      \n      return data;\n    } catch (err) {\n      console.error(\"Failed to verify MFA setup:\", err);\n      throw err;\n    }\n  }\n\n  /**\n   * Authenticate with MFA during login\n   * @param code - The TOTP code from the authenticator app\n   * @param userId - The user ID to authenticate\n   * @param sessionId - Optional session ID for tracking\n   * @returns Authentication result\n   */\n  async authenticate(code: string, userId: string, sessionId?: string): Promise<MFAAuthenticationResponse> {\n    try {\n      const { data, error } = await this.callMFAEndpoint<MFAAuthenticationResponse>(\"authenticate\", {\n        code,\n        userId,\n        sessionId\n      });\n      \n      if (error) {\n        throw new Error(error.message);\n      }\n      \n      return data;\n    } catch (err) {\n      console.error(\"Failed to authenticate with MFA:\", err);\n      throw err;\n    }\n  }\n\n  /**\n   * Validate a recovery code\n   * @param code - The recovery code\n   * @param userId - The user ID\n   * @param sessionId - Optional session ID for tracking\n   * @returns Validation result\n   */\n  async validateRecoveryCode(code: string, userId: string, sessionId?: string): Promise<MFARecoveryResponse> {\n    try {\n      const { data, error } = await this.callMFAEndpoint<MFARecoveryResponse>(\"validate-recovery\", {\n        code,\n        userId,\n        sessionId\n      });\n      if (error) {\n        throw new Error(error.message);\n      }\n      \n      return data;\n    } catch (err) {\n      console.error(\"Failed to validate recovery code:\", err);\n      throw err;\n    }\n  }\n\n  /**\n   * Disable MFA for the current user\n   * @param code - Optional TOTP code for verification (required for non-admin users)\n   * @returns Result of the operation\n   */\n  async disableMFA(code?: string): Promise<{ success: boolean; message: string }> {\n    try {\n      const { data, error } = await this.callMFAEndpoint<{ success: boolean; message: string }>(\"disable\", {\n        code\n      });\n      \n      if (error) {\n        throw new Error(error.message);\n      }\n      \n      return data;\n    } catch (err) {\n      console.error(\"Failed to disable MFA:\", err);\n      throw err;\n    }\n  }\n\n  /**\n   * Get the current MFA status\n   * @returns MFA status information\n   */\n  async getMFAStatus(): Promise<MFAStatusResponse> {\n    try {\n      const { data, error } = await this.callMFAEndpoint<MFAStatusResponse>(\"status\", {}, \"GET\");\n      \n      if (error) {\n        throw new Error(error.message);\n      }\n      \n      return data;\n    } catch (err) {\n      console.error(\"Failed to get MFA status:\", err);\n      throw err;\n    }\n  }\n\n  /**\n   * Regenerate recovery codes\n   * @param code - TOTP code for verification\n   * @returns New recovery codes\n   */\n  async regenerateRecoveryCodes(code: string): Promise<MFAVerificationResponse> {\n    try {\n      const { data, error } = await this.callMFAEndpoint<MFAVerificationResponse>(\"regenerate-recovery-codes\", {\n        code\n      });\n      \n      if (error) {\n        throw new Error(error.message);\n      }\n      \n      return data;\n    } catch (err) {\n      console.error(\"Failed to regenerate recovery codes:\", err);\n      throw err;\n    }\n  }\n\n  /**\n   * Check if MFA is required for a user\n   * @param userId - User ID to check\n   * @returns Whether MFA is required\n   */\n  async isMFARequired(userId: string): Promise<boolean> {\n    try {\n      // Get user profile to check if MFA is enabled\n      const { data: profile, error } = await supabase\n        .from(\"profiles\")\n        .select(\"mfa_enabled, mfa_verified\")\n        .eq(\"id\", userId)\n        .single();\n      \n      if (error) {\n        throw new Error(error.message);\n      }\n      \n      return profile?.mfa_enabled && profile?.mfa_verified;\n    } catch (err) {\n      console.error(\"Failed to check if MFA is required:\", err);\n      return false; // Default to not requiring MFA on error\n    }\n  }\n\n  /**\n   * Call an MFA endpoint\n   * @param endpoint - Endpoint to call\n   * @param body - Request body\n   * @param method - HTTP method\n   * @returns Response data and error\n   */\n  private async callMFAEndpoint<T>(\n    endpoint: string,\n    body: Record<string, any> = {},\n    method: \"GET\" | \"POST\" = \"POST\"\n  ): Promise<{ data: T; error: Error | null }> {\n    try {\n      // Get the current session\n      const { data: { session } } = await supabase.auth.getSession();\n      \n      if (!session) {\n        throw new Error(\"No active session\");\n      }\n      \n      const url = `${this.baseUrl}/${endpoint}`;\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": `Bearer ${session.access_token}`\n      };\n      \n      let response;\n      if (method === \"GET\") {\n        response = await fetch(url, { headers, method });\n      } else {\n        response = await fetch(url, {\n          method,\n          headers,\n          body: JSON.stringify(body)\n        });\n      }\n      \n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || `HTTP error ${response.status}`);\n      }\n      \n      const data = await response.json();\n      return { data: data as T, error: null };\n    } catch (err) {\n      return { data: {} as T, error: err as Error };\n    }\n  }\n}\n\n// Export a singleton instance\nexport const mfaService = new MFAService();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}