{"version":3,"names":["React","useState","useEffect","useCallback","View","StyleSheet","createMaterialTopTabNavigator","HomeScreen","MapScreen","getCurrentLocation","useAuth","DEFAULT_FILTERS","loadTemporaryFilters","saveTemporaryFilters","jsx","_jsx","jsxs","_jsxs","Tab","cov_180pdatppx","s","HomeTabsScreen","_ref","navigation","f","_ref2","authState","_ref3","_user","user","userId","id","_ref4","_ref5","_slicedToArray","filters","setFilters","_ref6","_ref7","userLocation","setUserLocation","_ref8","_ref9","_activeTab","setActiveTab","b","_asyncToGenerator","stored","Object","assign","e","console","warn","catch","fetchLocation","_ref1","location","error","apply","arguments","handleFilterChange","newFilters","handleShowPress","showId","navigate","handleTabChange","index","style","styles","container","children","Navigator","screenOptions","tabBarActiveTintColor","tabBarInactiveTintColor","tabBarIndicatorStyle","backgroundColor","tabBarStyle","tabBar","tabBarLabelStyle","tabLabel","screenListeners","state","_e$data$state","data","Screen","name","props","customFilters","onFilterChange","onShowPress","initialUserLocation","create","flex","elevation","shadowColor","shadowOffset","width","height","shadowOpacity","shadowRadius","fontWeight","textTransform","fontSize"],"sources":["HomeTabsScreen.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { View, StyleSheet } from 'react-native';\nimport { createMaterialTopTabNavigator } from '@react-navigation/material-top-tabs';\nimport { NativeStackScreenProps } from '@react-navigation/native-stack';\nimport HomeScreen from './HomeScreen';\nimport MapScreen from '../Map/MapScreen';\nimport { ShowFilters, Coordinates } from '../../types';\nimport { getCurrentLocation } from '../../services/locationService';\nimport { useAuth } from '../../contexts/AuthContext';\nimport {\n  DEFAULT_FILTERS,\n  loadTemporaryFilters,\n  saveTemporaryFilters,\n} from '../../services/filterService';\n\n// Define the main stack param list type\ntype MainStackParamList = {\n  MainTabs: undefined;\n  ShowDetail: { showId: string };\n};\n\ntype Props = NativeStackScreenProps<MainStackParamList>;\n\n// Create top tab navigator\nconst Tab = createMaterialTopTabNavigator();\n\n/**\n * HomeTabsScreen\n * \n * Container component that provides a tabbed interface between list and map views.\n * Manages shared state (filters, location) between the views and handles persistence.\n */\nconst HomeTabsScreen: React.FC<Props> = ({ navigation }) => {\n  const { authState } = useAuth();\n  const { user: _user } = authState;\n  const userId = _user?.id;\n\n  // Shared state\n  const [filters, setFilters] = useState<ShowFilters>(DEFAULT_FILTERS);\n  const [userLocation, setUserLocation] = useState<Coordinates | null>(null);\n  // `activeTab` is currently unused but kept for potential future\n  // analytics or state-driven styling; prefix with underscore to\n  // satisfy eslint-unused-vars rule.\n  const [_activeTab, setActiveTab] = useState<'list' | 'map'>('list');\n\n  /**\n   * ------------------------------------------------------------------\n   * User-scoped filter persistence\n   * ------------------------------------------------------------------\n   */\n  // Load filters when user changes\n  useEffect(() => {\n    if (!userId) {\n      setFilters(DEFAULT_FILTERS);\n      return;\n    }\n\n    (async () => {\n      try {\n        const stored = await loadTemporaryFilters(userId);\n        if (stored) {\n          setFilters({ ...DEFAULT_FILTERS, ...stored });\n        } else {\n          setFilters(DEFAULT_FILTERS);\n        }\n      } catch (e) {\n        console.warn('[HomeTabsScreen] Failed to load user filters', e);\n      }\n    })();\n  }, [userId]);\n\n  // Persist filters whenever they change (and we have a user)\n  useEffect(() => {\n    if (!userId) return;\n    saveTemporaryFilters(userId, filters).catch((e) =>\n      console.warn('[HomeTabsScreen] Failed to save user filters', e)\n    );\n  }, [userId, filters]);\n\n  // Get user location on mount\n  useEffect(() => {\n    const fetchLocation = async () => {\n      try {\n        const location = await getCurrentLocation();\n        if (location) {\n          setUserLocation(location);\n        }\n      } catch (error) {\n        console.error('Error getting user: _user location:', error);\n      }\n    };\n\n    fetchLocation();\n  }, []);\n\n  // Handle filter changes\n  const handleFilterChange = useCallback((newFilters: ShowFilters) => {\n    setFilters(newFilters);\n  }, []);\n\n  // Handle show selection\n  const handleShowPress = useCallback((showId: string) => {\n    navigation.navigate('ShowDetail', { showId });\n  }, [navigation]);\n\n  // Handle tab change\n  const handleTabChange = (index: number) => {\n    setActiveTab(index === 0 ? 'list' : 'map');\n  };\n\n  return (\n    <View style={styles.container}>\n      <Tab.Navigator\n        screenOptions={{\n          tabBarActiveTintColor: '#007AFF',\n          tabBarInactiveTintColor: '#666',\n          tabBarIndicatorStyle: { backgroundColor: '#007AFF' },\n          tabBarStyle: styles.tabBar,\n          tabBarLabelStyle: styles.tabLabel,\n        }}\n        screenListeners={{\n          state: (e) => {\n            const index = e.data.state?.index || 0;\n            handleTabChange(index);\n          },\n        }}\n      >\n        <Tab.Screen name=\"List\">\n          {(props) => (\n            <HomeScreen\n              {...props}\n              customFilters={filters}\n              onFilterChange={handleFilterChange}\n              onShowPress={handleShowPress}\n            />\n          )}\n        </Tab.Screen>\n        <Tab.Screen name=\"Map\">\n          {(props) => (\n            <MapScreen {...props} initialUserLocation={userLocation} />\n          )}\n        </Tab.Screen>\n      </Tab.Navigator>\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f8f8f8',\n  },\n  tabBar: {\n    backgroundColor: 'white',\n    elevation: 2,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 3,\n  },\n  tabLabel: {\n    fontWeight: '600',\n    textTransform: 'none',\n    fontSize: 14,\n  },\n});\n\nexport default HomeTabsScreen;\n"],"mappings":"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","ignoreList":[]}