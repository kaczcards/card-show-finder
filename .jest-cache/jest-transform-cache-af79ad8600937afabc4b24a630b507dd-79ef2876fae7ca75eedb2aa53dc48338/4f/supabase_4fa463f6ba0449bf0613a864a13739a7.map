{"version":3,"names":["createClient","AsyncStorage","Constants","_supabaseUrl","cov_1sukd5hs0x","s","b","_env","EXPO_PUBLIC_SUPABASE_URL","_Constants$expoConfig","expoConfig","extra","supabaseUrl","_supabaseAnonKey","EXPO_PUBLIC_SUPABASE_ANON_KEY","_Constants$expoConfig2","supabaseAnonKey","__DEV__","console","warn","slice","error","_supabaseSingleton","auth","storage","autoRefreshToken","persistSession","detectSessionInUrl","_supabase","_isSupabaseInitialized","f","Boolean","_err","_getSupabase","Error","_recreateSupabaseClient","supabase","isSupabaseInitialized","getSupabase","recreateSupabaseClient"],"sources":["supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport Constants from 'expo-constants';\n\n// Supabase configuration - ideally from environment variables\nconst _supabaseUrl = process.env.EXPO_PUBLIC_SUPABASE_URL || Constants.expoConfig?.extra?.supabaseUrl || '';\nconst _supabaseAnonKey = process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY || Constants.expoConfig?.extra?.supabaseAnonKey || '';\n\n/* -------------------------------------------------------------------------- */\n/*  üîç DIAGNOSTICS ‚Äì PRINT SUPABASE CREDS IN DEV                              */\n/* -------------------------------------------------------------------------- */\n// NOTE: These values are **public** (anon key & project URL) so it's safe\n// to log them for debugging.  Remove or wrap behind an env‚Äêguard before\n// shipping production builds if desired.\nif (typeof __DEV__ !== 'undefined' && __DEV__) {\n  console.warn(\n    '\\n================= [SUPABASE CONFIG] =================\\n' +\n      `‚Ä¢ SUPABASE URL : ${_supabaseUrl || '<EMPTY>'}\\n` +\n      `‚Ä¢ ANON KEY     : ${_supabaseAnonKey?.slice(0, 8) || '<EMPTY>'}‚Ä¶\\n` +\n      '====================================================\\n'\n  );\n}\n\n/* -------------------------------------------------------------------------- */\n/* 1. Guard-rails / configuration validation                                  */\n/* -------------------------------------------------------------------------- */\n\nif (!_supabaseUrl || !_supabaseAnonKey) {\n  // Fail fast ‚Äì running with a broken client leads to subtle bugs later\n  console.error(\n    '[_Supabase] Missing configuration. ' +\n      'Ensure EXPO_PUBLIC_SUPABASE_URL and EXPO_PUBLIC_SUPABASE_ANON_KEY are set.'\n  );\n}\n\n/* -------------------------------------------------------------------------- */\n/* 2. Singleton client creation                                               */\n/* -------------------------------------------------------------------------- */\n\n/**\n * Internal holder for the Supabase singleton.\n * We keep it in a `let` so tests (or a logout flow) can force-recreate it\n * via `recreateSupabaseClient()`.\n */\nlet _supabaseSingleton = createClient(_supabaseUrl, _supabaseAnonKey, {\n  auth: {\n    storage: AsyncStorage,\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: false, // we never use browser-based auth redirects\n  },\n});\n\n/**\n * Public accessor used throughout the codebase to avoid importing\n * `createClient` elsewhere.  Always returns **the same** instance.\n */\nexport const _supabase = _supabaseSingleton;\n\n/* -------------------------------------------------------------------------- */\n/* 3. Helper utilities                                                        */\n/* -------------------------------------------------------------------------- */\n\n/**\n * Defensive check used by legacy code (`isSupabaseInitialized()`).\n */\nexport const _isSupabaseInitialized = (): boolean => {\n  try {\n    return Boolean(_supabaseSingleton && _supabaseSingleton.auth);\n  } catch (_err) {\n    console.error('[_Supabase] initialization check failed:', _err);\n    return false;\n  }\n};\n\n/**\n * Provides the singleton client or throws a descriptive error.\n * Prefer this helper in newly-written code so errors surface early.\n */\nexport const _getSupabase = () => {\n  if (!_isSupabaseInitialized()) {\n    throw new Error(\n      '[_Supabase] Client not initialised ‚Äì check environment variables.'\n    );\n  }\n  return _supabaseSingleton;\n};\n\n/**\n * Optional helper to **re**create the client (e.g. after logout to purge\n * cached auth state, or inside E2E tests).  Most apps will never need this.\n */\nexport const _recreateSupabaseClient = () => {\n  _supabaseSingleton = createClient(_supabaseUrl, _supabaseAnonKey, {\n    auth: {\n      storage: AsyncStorage,\n      autoRefreshToken: true,\n      persistSession: true,\n      detectSessionInUrl: false,\n    },\n  });\n  return _supabaseSingleton;\n};\n\n// Export types from Supabase for use in other files\nexport type { User, Session } from '@supabase/supabase-js';\n\n/* -------------------------------------------------------------------------- */\n/* 4. Back-compat exports (non-underscore names)                               */\n/* -------------------------------------------------------------------------- */\n// Many legacy modules still import these helpers without the leading\n// underscore.  Re-export them here so existing imports continue to work\n// while new code can adopt the explicit ‚Äúprivate‚Äù underscore versions.\n\nexport const supabase = _supabase;\nexport const isSupabaseInitialized = _isSupabaseInitialized;\nexport const getSupabase = _getSupabase;\nexport const recreateSupabaseClient = _recreateSupabaseClient;\n"],"mappings":"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","ignoreList":[]}